'=======================
' IMPORT BDC ULTRA-MINIMALISTE
'=======================
Option Explicit

Sub ImporterBDC_Minimaliste()
    Dim FichierBDC As Variant
    Dim wbBDC As Workbook, wsBDC As Worksheet
    Dim wsDest As Worksheet
    Dim Derligne As Long, i As Long, nbLigneReserv As Long
    Dim Tablo As Variant
    
    ' 1. Sélection du BDC (fichier Excel)
    FichierBDC = Application.GetOpenFilename("Fichier BDC (*.xls*), *.xls*", , "Sélectionner le BDC")
    If VarType(FichierBDC) = vbBoolean Then Exit Sub 'Annulation
    
    ' 2. Ouverture du BDC
    Set wbBDC = Workbooks.Open(FichierBDC, Local:=True)
    Set wsBDC = wbBDC.Sheets(1) 'Suppose que le BDC est toujours en première feuille
    
    ' 3. Détection de la dernière ligne de données (colonne A)
    Derligne = wsBDC.Range("A" & wsBDC.Rows.Count).End(xlUp).Row
    
    ' 4. Extraction des données SANS entête (suppose entête en ligne 4)
    Tablo = wsBDC.Range("A5:BG" & Derligne).Value
    
    ' 5. Création de la feuille destination (supprime si déjà présente)
    On Error Resume Next
    Application.DisplayAlerts = False
    ThisWorkbook.Sheets("Import_BDC").Delete
    Application.DisplayAlerts = True
    On Error GoTo 0
    Set wsDest = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))
    wsDest.Name = "Import_BDC"
    
    ' 6. Entêtes en première ligne de la feuille cible (adapte selon tes besoins)
    wsDest.Range("A1").Value = "N°"
    wsDest.Range("B1").Value = "EXT"
    wsDest.Range("C1").Value = "VOIE"
    wsDest.Range("D1").Value = "VILLE"
    wsDest.Range("E1").Value = "OBS"
    wsDest.Range("F1").Value = "ID"
    ' ... ajoute les entêtes utiles jusqu'à BG (ou seulement les colonnes que tu veux)
    
    nbLigneReserv = 1 'car entête en ligne 1
    
    ' 7. Copie brute ligne à ligne
    For i = 1 To UBound(Tablo, 1)
        wsDest.Cells(i + nbLigneReserv, 1).Value = Tablo(i, 1)   'Colonne A = N°
        wsDest.Cells(i + nbLigneReserv, 2).Value = Tablo(i, 2)   'Colonne B = EXT
        wsDest.Cells(i + nbLigneReserv, 3).Value = Tablo(i, 3)   'Colo
